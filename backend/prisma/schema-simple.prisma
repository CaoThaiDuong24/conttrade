// Simple Schema for i-ContExchange
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// =============================================
// CORE MODELS
// =============================================

model User {
  id          String   @id @default(cuid())
  email       String   @unique
  password    String
  displayName String?
  avatar      String?
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Relations
  listings    Listing[]
  
  @@map("users")
}

model Listing {
  id                String   @id @default(cuid())
  sellerUserId      String   // Match backend code
  dealType          String   // 'sale' or 'rental'
  title             String
  description       String?
  priceAmount       Decimal
  priceCurrency     String   @default("VND")
  locationDepotId   String
  status            String   @default("pending_review")
  
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  
  // Relations
  seller            User @relation(fields: [sellerUserId], references: [id])
  facets            ListingFacet[]
  
  @@map("listings")
}

model ListingFacet {
  id        String   @id @default(cuid())
  listingId String
  key       String
  value     String
  
  createdAt DateTime @default(now())
  
  listing   Listing @relation(fields: [listingId], references: [id], onDelete: Cascade)
  
  @@map("listing_facets")
}